def call_api_login():
    url = f"{API_BASE}/api/v2/Usuario/ValidarLogin"
    files = {
        'dsUsuario': (None, 'root.fg'),
        'dsSenha': (None, 'Fg@2025@')
    }
    headers = {'dsCliente': API_CLIENT, 'dsChaveAutenticacao': AUTENTICACAO}
    resp = requests.post(url, headers=headers, files=files)
    resp.raise_for_status()
    token = resp.json().get("tokenUsuario")
    logging.info("Login OK, token recebido")
    return token

token = call_api_login()



    def call_avancar_Fluxo():
    url=f"{API_BASE}/api/v1/Fluxo/AvancaFluxo";
    payload =json.dumps({
        "lstCamposForm":[],
        "lstExecutores": [{"cdUsuario":2}]
    });
    headers = {
    'dsCliente': f'{API_CLIENT}',
    'dsChaveAutenticacao': f'{API_KEY}',
    'dsEmailExecutor': f'{EMAIL_EXEC}',
    'cdFluco': f'{COD_FLUXO}',
    'Content-Type' : 'application/json' 
    };
    response = requests.post(url, headers=headers, data=payload);
    response.raise_for_status();
    return response;




def avanca_fluxo(token, cod_fluxo, cod_tarefa):
    url = f"{API_BASE}/api/v2/Fluxo/AvancaFluxo"
    
    headers = {
        'dsCliente': str(API_CLIENT),
        'dsChaveAutenticacao': f"{AUTENTICACAO}",
        'tokenUsuario': f"{token}",
        'cdFluxo': str(cod_fluxo),
        'cdTarefa': str(cod_tarefa),
        'cdOpcao': OPCAO,
        'Content-Type': 'application/json'
    }

    response = requests.post(url, headers=headers, json={
    "lstCamposForm": [],
    "lstExecutores": [{"cdUsuario": 2}]})
    print("STATUS:", response.status_code)
    print("BODY:", response.text)

    response.raise_for_status()
    print("Fluxo avan√ßado com sucesso.")
    return response
response = avanca_fluxo(token, cod_fluxo, cod_tarefa)
print(response)